# ContextForge Environment Configuration Example
# =============================================================================
# Copy this file to .env and customize for your environment.
# =============================================================================

# =============================================================================
# LLM Configuration
# =============================================================================
# Priority order: comma-separated list of backends to try in order
# Options: local (ollama/lm_studio), cloud (openai/anthropic/gemini)
LLM_PRIORITY=local,cloud

# Ollama (local) - PRIMARY for local mode
OLLAMA_URL=http://localhost:11434/api/generate
OLLAMA_MODEL=llama2-13b-code

# LM Studio (local) - FALLBACK for local mode
LM_STUDIO_URL=http://localhost:1234/v1/chat/completions

# Cloud LLM API Keys (uncomment and set for cloud mode)
# CLOUD_LLM_API_KEY=your_key_here
# OPENAI_API_KEY=sk-your-openai-key
# ANTHROPIC_API_KEY=sk-ant-your-anthropic-key
# GEMINI_API_KEY=your-gemini-key
# MISTRAL_API_KEY=your-mistral-key

# DeepSeek (open source, competitive performance)
# DEEPSEEK_API_KEY=your-deepseek-key
# DEEPSEEK_API_URL=https://api.deepseek.com/v1/chat/completions
# DEEPSEEK_MODEL=deepseek-chat

# LLM Settings
LLM_TIMEOUT=60
LLM_MAX_TOKENS=512
LLM_TEMPERATURE=0.7

# =============================================================================
# Database Configuration
# =============================================================================
# Database type: postgresql (recommended for 500k+ LOC), sqlite, memory
DB_TYPE=postgresql

# PostgreSQL settings
DB_HOST=localhost
DB_PORT=5432
DB_USER=contextforge
DB_PASS=yourpassword
DB_NAME=contextforge_db
DATABASE_URL=postgresql://contextforge:yourpassword@localhost:5432/contextforge_db

# Enable PostgreSQL persistence (set to true for production)
USE_POSTGRES=false

# =============================================================================
# Redis Cache Configuration
# =============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_URL=redis://localhost:6379/0
REDIS_PREFIX=contextforge:
REDIS_CACHE_TTL=3600

# Enable Redis cache (recommended for production)
USE_REDIS=false

# =============================================================================
# Search / Indexing Configuration
# =============================================================================
# Chunking settings (in tokens)
CHUNK_SIZE=1024
CHUNK_OVERLAP=100
MAX_CHUNK_SIZE=2048
MIN_CHUNK_SIZE=128

# Embedding model (all-mpnet-base-v2 recommended for quality)
EMBEDDING_MODEL=all-mpnet-base-v2
CODE_EMBEDDING_MODEL=microsoft/codebert-base
USE_CODE_EMBEDDINGS=true
EMBEDDING_DIM=768

# FAISS settings (HNSW recommended for large repos)
FAISS_INDEX_TYPE=HNSW
FAISS_HNSW_NEIGHBORS=32
FAISS_NPROBE=10
FAISS_INDEX_PATH=data/vector_index/faiss_index.index

# Hybrid search (semantic + lexical)
HYBRID_SEARCH_ENABLED=true
DENSE_WEIGHT=0.7
LEXICAL_WEIGHT=0.3

# Recency boost for recent code changes
RECENCY_BOOST_ENABLED=true
RECENCY_BOOST_FACTOR=0.1

# Search parameters
VECTOR_TOP_K=10
RERANK_ENABLED=true
RERANK_TOP_K=50

# =============================================================================
# Privacy / Logging Configuration
# =============================================================================
PRIVACY_MODE=true
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(levelname)s - %(name)s - %(message)s
LOG_FILE=logs/contextforge.log
LOG_TO_FILE=false

# =============================================================================
# Auto-Terminal / Agent Configuration
# =============================================================================
AUTO_TERMINAL_MODE=true
AUTO_TERMINAL_TIMEOUT=30
AUTO_TERMINAL_MAX_OUTPUT=10000
AUTO_TERMINAL_SAFE_ONLY=true

# =============================================================================
# Web Search Configuration
# =============================================================================
ENABLE_WEB_SEARCH=false
WEB_SEARCH_PROVIDER=google
WEB_SEARCH_API_KEY=
WEB_CACHE_TTL=86400

# SerpAPI (Google Search)
SERPAPI_KEY=

# Bing Web Search API
BING_SUBSCRIPTION_KEY=

# Google Custom Search Engine
GOOGLE_CSE_KEY=
GOOGLE_CSE_ID=

# =============================================================================
# Service URLs (for local development / Docker Compose)
# =============================================================================
VECTOR_INDEX_URL=http://localhost:8001
PREPROCESSOR_URL=http://localhost:8003
CONNECTOR_URL=http://localhost:8002
WEB_FETCHER_URL=http://localhost:8004
TERMINAL_EXECUTOR_URL=http://localhost:8006

# =============================================================================
# Agent Orchestration Configuration
# =============================================================================
AGENT_MAX_CONCURRENT=4
AGENT_HEARTBEAT_INTERVAL=10
AGENT_TASK_TIMEOUT=300
AGENT_RETRY_ATTEMPTS=3

# =============================================================================
# Scaling Configuration (for large repos)
# =============================================================================
# Enable parallel indexing for repos > 500k LOC
PARALLEL_INDEXING_ENABLED=true
MODULE_LEVEL_PARALLELISM=true
MAX_INDEXING_WORKERS=4
BATCH_SIZE=100

# Incremental indexing (only re-index changed files)
INCREMENTAL_INDEX_ENABLED=true
INDEX_WATCH_ENABLED=false
INDEX_REFRESH_INTERVAL=86400
GIT_INTEGRATION_ENABLED=true

# =============================================================================
# VCS (Version Control) Provider Configuration
# =============================================================================
# Default VCS provider: github, gitlab, or bitbucket (auto-detected from remote URL if not set)
# VCS_PROVIDER=github

# GitHub Configuration
# GITHUB_TOKEN=ghp_your-github-token

# GitLab Configuration (supports GitLab.com and self-hosted)
# GITLAB_TOKEN=glpat-your-gitlab-token
# GITLAB_URL=https://gitlab.com

# Bitbucket Configuration
# BITBUCKET_TOKEN=your-bitbucket-app-password
# BITBUCKET_USERNAME=your-bitbucket-username

# =============================================================================
# Data Encryption Settings
# =============================================================================
# Enable data encryption for privacy-sensitive deployments
ENABLE_ENCRYPTION=false

# Encryption key (32 bytes, base64 encoded)
# Generate with: python -c "import secrets, base64; print(base64.b64encode(secrets.token_bytes(32)).decode())"
ENCRYPTION_KEY=

# Encrypt API keys in storage
ENCRYPT_API_KEYS=true

# Encrypt query content
ENCRYPT_QUERIES=false

# Encrypt context data
ENCRYPT_CONTEXT=false

# =============================================================================
# Data Directory Configuration
# =============================================================================
DATA_DIR=data
REPOS_DIR=data/repos
CACHE_DIR=data/cache
LOGS_DIR=logs

# =============================================================================
# Repo Size Recommendations
# =============================================================================
# 100k LOC: SQLite + Redis optional, single process indexing
# 500k LOC: PostgreSQL + Redis + multi-threaded FAISS HNSW
# 1-2M LOC: Distributed agents + disk-backed FAISS + module parallelism
# 2M+ LOC: Hybrid cloud with local embeddings + cloud LLM reasoning
